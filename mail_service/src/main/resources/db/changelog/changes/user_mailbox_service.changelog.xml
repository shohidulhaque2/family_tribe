<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">

  <changeSet author="shohidul haque" id="1">
    <createTable tableName="mail">
      <column name="mail_type" type="VARCHAR(31)">
        <constraints nullable="false"/>
      </column>
      <column autoIncrement="true" name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true"/>
      </column>
      <column name="creation_time" type="datetime">
        <constraints nullable="false"/>
      </column>
      <column name="from_user_uuid" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="message" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="seen" type="BIT(1)">
        <constraints nullable="false"/>
      </column>
      <column name="uuid" type="VARCHAR(255)">
        <constraints nullable="false" unique="true"/>
      </column>
      <column name="version" type="BIGINT">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="shohidul haque" id="2">
    <createTable tableName="mailbox">
      <column autoIncrement="true" name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true"/>
      </column>
      <column name="creation_time" type="datetime">
        <constraints nullable="false"/>
      </column>
      <column name="user_uuid" type="VARCHAR(255)">
        <constraints nullable="false" unique="true"/>
      </column>
      <column name="version" type="BIGINT">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="shohidul haque" id="3">
    <createTable tableName="mailbox_mail">
      <column name="mailbox_id" type="BIGINT">
        <constraints nullable="false"/>
      </column>
      <column name="mail_id" type="BIGINT">
        <constraints nullable="false" unique="true"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="shohidul haque" id="4">
    <createIndex indexName="INDEX_TABLE_mailbox_mail_COLUMN_mailbox_id" tableName="mailbox_mail">
      <column name="mailbox_id"/>
    </createIndex>
  </changeSet>
  <changeSet author="shohidul haque" id="5">
    <addForeignKeyConstraint baseColumnNames="mailbox_id" baseTableName="mailbox_mail" constraintName="FK_mailbox_mail(mailbox_id)_TO_mailbox(id)" deferrable="false" initiallyDeferred="false" onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="mailbox" validate="true"/>
  </changeSet>
  <changeSet author="shohidul haque" id="6">
    <addForeignKeyConstraint baseColumnNames="mail_id" baseTableName="mailbox_mail" constraintName="FK_mailbox_mail(mail_id)_TO_mail(id)" deferrable="false" initiallyDeferred="false" onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="mail" validate="true"/>
  </changeSet>

</databaseChangeLog>
